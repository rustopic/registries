# Rust Game Adapter Configuration
# Defines Rust-specific operations and path mappings

gameId: rust
version: "1.0.0"

# Path mappings for resource discovery
# {IDENTITY} placeholder is replaced with SERVER_IDENTITY variable value at runtime
paths:
  # Server root path (absolute or relative to container root)
  serverRoot: "/server"
  
  # Identity root template - used by Astralis to resolve server/identity/** paths
  # Template format: /server/{{identity}} where {{identity}} is replaced at runtime
  identityRootTemplate: "/server/{{identity}}"
  
  # Server configuration files
  serverConfig: "server/{IDENTITY}/cfg/server.cfg"
  
  # Identity-specific paths (identity folder name is runtime-provided)
  identityRoot: "server/{IDENTITY}"
  identityConfig: "server/{IDENTITY}/cfg/server.cfg"
  identityLogs: "server/{IDENTITY}/logs"
  identitySaves: "server/{IDENTITY}/saves"
  
  # Oxide framework paths
  oxideRoot: "server/{IDENTITY}/oxide"
  oxideConfig: "server/{IDENTITY}/oxide/config"
  oxidePlugins: "server/{IDENTITY}/oxide/plugins"
  oxideData: "server/{IDENTITY}/oxide/data"
  oxideLang: "server/{IDENTITY}/oxide/lang"
  
  # Carbon framework paths
  carbonRoot: "server/{IDENTITY}/carbon"
  carbonConfig: "server/{IDENTITY}/carbon/config"
  carbonPlugins: "server/{IDENTITY}/carbon/plugins"
  carbonData: "server/{IDENTITY}/carbon/data"
  carbonLang: "server/{IDENTITY}/carbon/lang"

# Variable mapping for Astralis daemon
# Maps registry variable names to environment variable keys
variableMapping:
  identityKey: "SERVER_IDENTITY"
  portKey: "SERVER_PORT"
  nameKey: "SERVER_NAME"

# Action support configuration
# Defines how Astralis should handle maintenance actions
actionSupport:
  wipe:
    # Identity root path template for wipe operations
    identityRoot: "{{paths.identityRootTemplate}}"
    # Whether to use base delete patterns from wipeProfiles
    baseDeletePatternsFromProfiles: true

# Reload command templates
reload:
  # Reload server configuration
  config:
    command: "server.writecfg"
    description: "Reloads server.cfg configuration"
    
  # Reload all plugins
  plugins:
    command: "oxide.reload *"
    description: "Reloads all Oxide plugins"
    
  # Reload specific plugin
  plugin:
    command: "oxide.reload {PLUGIN_NAME}"
    description: "Reloads a specific Oxide plugin by name"
    parameters:
      - name: PLUGIN_NAME
        description: "Name of the plugin to reload"
        required: true

# Resource discovery hints
# These help the daemon locate and categorize server resources
discovery:
  # Configuration files
  configs:
    - pattern: "**/server.cfg"
      type: "server_config"
      editable: true
    - pattern: "**/oxide/config/**/*.json"
      type: "plugin_config"
      editable: true
      
  # Plugin files
  plugins:
    - pattern: "**/oxide/plugins/*.cs"
      type: "compiled_plugin"
      editable: false
    - pattern: "**/oxide/plugins/*.dll"
      type: "compiled_plugin"
      editable: false
      
  # Data files
  data:
    - pattern: "**/oxide/data/**/*.json"
      type: "plugin_data"
      editable: true
    - pattern: "**/oxide/data/**/*.db"
      type: "plugin_database"
      editable: false
      
  # Log files
  logs:
    - pattern: "**/logs/*.log"
      type: "server_log"
      editable: false
    - pattern: "**/oxide/logs/*.txt"
      type: "plugin_log"
      editable: false

# Game-specific operations
operations:
  # Save world
  save:
    command: "server.save"
    description: "Manually save the game world"
    
  # Wipe server
  wipe:
    command: "server.wipe"
    description: "Wipe all server data (destructive)"
    confirmationRequired: true
    
  # Broadcast message
  broadcast:
    command: "chat.say {MESSAGE}"
    description: "Broadcast a message to all players"
    parameters:
      - name: MESSAGE
        description: "Message to broadcast"
        required: true

